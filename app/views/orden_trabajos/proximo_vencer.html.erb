<div class="block-center mx-5">
  <h3 class="my-3 text-center">
    <strong>TRABAJOS PRÃ“XIMOS A VENCER</strong>
  </h3>

  <table class="table table-striped table-bordered shadow-sm align-middle">
    <thead class="bg-dark text-white text-center">
      <tr>
        <th>OT</th>
        <th>Cliente</th>
        <th>Producto</th>
        <th>Fecha Entrega</th>
        <th>Prioridad</th>
        <th>AcciÃ³n</th>
      </tr>
    </thead>

    <tbody>
      <% @orden_trabajos.limit(35).each do |orden_trabajo| %>
        <tr id="orden_trabajo_<%= orden_trabajo.id %>">
          <%= simple_form_for orden_trabajo,
                html: { class: "d-inline", data: { controller: "form", action: "ajax:success->form#onPostSuccess" } },
                remote: true do |f| %>

            <%# ðŸ”¸ Columna OT con color segÃºn prioridad %>
            <% case orden_trabajo.priority
               when "Alta" %>
                 <td style="background-color:#FF0000;"><strong><%= orden_trabajo.trnum %></strong></td>
               <% when "Media" %>
                 <td style="background-color:#FFFF00;"><strong><%= orden_trabajo.trnum %></strong></td>
               <% else %>
                 <td style="background-color:#7CFC00;"><strong><%= orden_trabajo.trnum %></strong></td>
            <% end %>

            <%# ðŸ”¸ Datos principales %>
            <td><%= link_to orden_trabajo.clinom, orden_trabajo_path(orden_trabajo), class: "text-decoration-none fw-bold" %></td>
            <td><%= orden_trabajo.nomprod.first(20) %></td>
            <td><strong><%= orden_trabajo.deadline.try(:strftime, "%d-%m-%Y") %></strong></td>

            <%# ðŸ”¸ Selector editable de prioridad %>
            <td>
              <%= f.input :priority,
                  as: :select,
                  collection: ["Alta", "Media", "Baja"],
                  label: false,
                  input_html: { class: "form-select form-select-sm" } %>
            </td>

            <%# ðŸ”¸ BotÃ³n de confirmaciÃ³n %>
            <td class="text-center">
              <%= f.button :submit, "Confirmar",
                  class: "btn btn-primary btn-sm",
                  data: { disable_with: "Guardando..." } %>
            </td>

          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
